{"version":3,"sources":["webpack:///./src/views/Dashboard/DashboardConfig.vue?8835","webpack:///./src/views/Dashboard/DashboardConfig.vue?f5ef","webpack:///./src/views/Dashboard/DashboardConfig.vue","webpack:///./src/views/Dashboard/DashboardConfig.vue?9220","webpack:///./src/views/Dashboard/DashboardConfig.vue?bdd5"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","ref","editor","language","theme","options","on","editorDidMount","model","value","callback","$$v","$set","expression","_e","staticStyle","_v","_s","$t","domProps","description","$store","getters","loading","modified","save","restoreConfig","staticRenderFns","automaticLayout","code","$vuetify","dark","originalCode","$logger","debug","$git","getContent","configFilePath","$sleep","$nextTick","editorRender","dump","JSON","parse","$noti","type","horizontal","vertical","content","stringify","load","commit","clear","update","onDidChangeCursorPosition","position","parsePath","split","lineNumber","key","reverse","join","$tf","config","root","url","user","userName","title","author","line","p","dep","match","empty","push","components","component","VBtn","VCol","VDivider","VRow"],"mappings":"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","file":"chunk/chunk-6917c8e1.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DashboardConfig.vue?vue&type=style&index=0&scope=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-row',{staticClass:\"ma-0 h-100\"},[_c('v-col',{attrs:{\"cols\":\"8\"}},[(_vm.editorRender)?_c('monaco-editor',{ref:\"code-editor\",staticClass:\"editor\",attrs:{\"language\":_vm.editor.language,\"theme\":_vm.editor.theme,\"options\":_vm.editor.options},on:{\"editorDidMount\":_vm.editorDidMount},model:{value:(_vm.editor.code),callback:function ($$v) {_vm.$set(_vm.editor, \"code\", $$v)},expression:\"editor.code\"}}):_vm._e()],1),_c('v-col',{staticClass:\"h-100\",attrs:{\"cols\":\"4\"}},[_c('v-row',{staticClass:\"ma-0\",staticStyle:{\"height\":\"85%\"}},[_c('v-col',{attrs:{\"cols\":\"12\"}},[_c('h3',[_vm._v(_vm._s(_vm.$t('dashboard.config.desc-title')))]),_c('v-divider',{staticClass:\"my-2\"}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.description)}})],1)],1),_c('v-row',{staticClass:\"ma-0\",staticStyle:{\"height\":\"15%\"},attrs:{\"align\":\"end\"}},[_c('v-col',{staticClass:\"pa-0\",attrs:{\"cols\":\"12\",\"align\":\"right\"}},[_c('v-btn',{attrs:{\"disabled\":_vm.$store.getters.loading || !_vm.modified,\"dark\":_vm.$store.getters.loading || _vm.modified,\"loading\":_vm.$store.getters.loading,\"depressed\":\"\",\"tile\":\"\",\"block\":\"\",\"color\":\"teal\"},on:{\"click\":_vm.save}},[_vm._v(\" \"+_vm._s(_vm.$t('save'))+\" \")]),_c('v-btn',{staticClass:\"mt-2\",attrs:{\"depressed\":\"\",\"tile\":\"\",\"block\":\"\",\"dark\":\"\",\"color\":\"red\"},on:{\"click\":_vm.restoreConfig}},[_vm._v(\" \"+_vm._s(_vm.$t('dashboard.config.restore-config'))+\" \")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Mixins } from 'vue-property-decorator';\nimport GlobalMixins from '@/plugins/mixins';\nimport yaml from 'js-yaml';\n\n@Component({\n\tcomponents: {\n\t},\n})\nexport default class DashboardConfig extends Mixins(GlobalMixins) {\n\tpublic editor: any = {\n\t\toptions: {\n\t\t\tautomaticLayout: true,\n\t\t},\n\t\tlanguage: 'yaml',\n\t\tcode: '',\n\t\ttheme: this.$vuetify.theme.dark ? 'vs-dark' : 'vs',\n\t};\n\tpublic originalCode: string = '';\n\tpublic readonly configFilePath: string = '_config.yml';\n\tpublic description: string = '';\n\tpublic editorRender: boolean = false;\n\n\tget modified() {\n\t\treturn this.originalCode !== this.editor.code;\n\t}\n\n\tpublic async mounted() {\n\t\tthis.$logger.debug('app', 'DashboardConfig mounted');\n\t\twhile ( true ) {\n\t\t\tthis.originalCode =\n\t\t\t\tthis.editor.code =\n\t\t\t\tawait this.$git.getContent<any>(this.configFilePath) || '';\n\t\t\tif ( this.originalCode ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tawait this.$sleep(500);\n\t\t}\n\n\t\tthis.$nextTick(() => {\n\t\t\tthis.editorRender = true;\n\t\t});\n\t}\n\n\tpublic change() {\n\t\tswitch ( this.editor.language ) {\n\t\t\tcase 'yaml':\n\t\t\t\ttry {\n\t\t\t\t\tthis.editor.code = yaml.dump(JSON.parse(this.editor.code));\n\t\t\t\t\tthis.originalCode = yaml.dump(JSON.parse(this.originalCode));\n\t\t\t\t} catch {\n\t\t\t\t\tthis.$noti({\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\thorizontal: 'right',\n\t\t\t\t\t\tvertical: 'top',\n\t\t\t\t\t\tcontent: this.$t('dashboard.config.dump-error'),\n\t\t\t\t\t});\n\t\t\t\t\tthis.$nextTick(() => this.editor.language = 'json');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'json':\n\t\t\t\ttry {\n\t\t\t\t\tthis.editor.code = JSON.stringify(yaml.load(this.editor.code), null, '\\t');\n\t\t\t\t\tthis.originalCode = JSON.stringify(yaml.load(this.originalCode), null, '\\t');\n\t\t\t\t} catch {\n\t\t\t\t\tthis.$noti({\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\thorizontal: 'right',\n\t\t\t\t\t\tvertical: 'top',\n\t\t\t\t\t\tcontent: this.$t('dashboard.config.parse-error'),\n\t\t\t\t\t});\n\t\t\t\t\tthis.$nextTick(() => this.editor.language = 'yaml');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tpublic async save() {\n\t\tthis.$store.commit('loading', true);\n\t\tlet code = this.editor.code;\n\t\tif ( this.editor.language === 'json' ) {\n\t\t\ttry {\n\t\t\t\tcode = yaml.dump(JSON.parse(code));\n\t\t\t} catch {\n\t\t\t\tthis.$noti({\n\t\t\t\t\ttype: 'error',\n\t\t\t\t\thorizontal: 'right',\n\t\t\t\t\tvertical: 'top',\n\t\t\t\t\tcontent: this.$t('dashboard.config.dump-error'),\n\t\t\t\t});\n\t\t\t\tthis.$store.commit('loading', false);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tawait this.$git.clear();\n\t\tthis.$git.update(this.configFilePath, code);\n\t\tawait this.$git.commit(`UPDATE: ${this.configFilePath}`);\n\t\tthis.originalCode = this.editor.code;\n\t\tthis.$store.commit('loading', false);\n\t}\n\n\tpublic editorDidMount(editor: any) {\n\t\teditor.onDidChangeCursorPosition(({ position }) => {\n\t\t\tconst parse = this.parsePath(this.editor.code.split('\\n'), position.lineNumber - 1);\n\t\t\tconst key = parse.reverse().join('>');\n\t\t\tthis.description = this.$tf(`dashboard.config.desc.${key}`, '');\n\t\t});\n\t}\n\n\tpublic async restoreConfig() {\n\t\tthis.$store.commit('loadmsg', this.$t('dashboard.config.restore-config'));\n\t\tthis.$store.commit('loading', true);\n\n\t\tconst config = await this.$git.getContent<any>('_config.yml', 'yaml', 'git-story/git-story-template');\n\t\tconfig.root = '/';\n\t\tconfig.url = `https://${this.$store.getters.user.userName}.github.io/`;\n\t\tconfig.title = config.author = this.$store.getters.user.userName;\n\n\t\tthis.editor.code = yaml.dump(config);\n\t\tthis.$git.clear();\n\t\tthis.$git.update(this.configFilePath, this.editor.code);\n\t\tawait this.$git.commit(`RESTORE: ${this.configFilePath}`);\n\t\tthis.$store.commit('loading', false);\n\t}\n\n\tprivate parsePath(code: string[], line: number, p: string[] = [], dep: string = '') {\n\t\tconst parse = code[line].match(/(\\s*)?(\\w*)?:/);\n\n\t\tif ( parse ) {\n\t\t\tconst empty = parse[1];\n\t\t\tconst key = parse[2];\n\n\t\t\tif ( empty !== dep ) {\n\t\t\t\tp.push(key);\n\t\t\t\tdep = empty;\n\n\t\t\t\tif ( !empty ) {\n\t\t\t\t\treturn p;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.parsePath(code, line - 1, p, dep);\n\t}\n\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DashboardConfig.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DashboardConfig.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./DashboardConfig.vue?vue&type=template&id=5f225d02&\"\nimport script from \"./DashboardConfig.vue?vue&type=script&lang=ts&\"\nexport * from \"./DashboardConfig.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./DashboardConfig.vue?vue&type=style&index=0&scope=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VCol,VDivider,VRow})\n"],"sourceRoot":""}